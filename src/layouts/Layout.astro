---
type Props = {
  title?: string;
  description?: string;
};

const {
  title = "Jaira Life RPG",
  description = "Tu universo personal gamificado",
} = Astro.props as Props;

const currentPath = Astro.url.pathname;
const BASE = import.meta.env.BASE_URL;

const withBase = (path: string) => {
  const clean = path.replace(/^\//, "");
  return `${BASE}${clean}`;
};

const normalize = (p: string) => p.replace(/\/+$/, "") || "/";
const isActive = (href: string) => {
  const full = withBase(href);
  return normalize(currentPath) === normalize(full);
};

const navItems = [
  { label: "home", href: "/", icon: "theme/icons/home.gif" },
  { label: "blog", href: "/blog/", icon: "theme/icons/blog.gif" },
  { label: "rpg", href: "/rpg/", icon: "theme/icons/rpg.gif" },
  // { label: "admin", href: "/admin/", icon: "theme/icons/admin.gif" },
];
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <title>{title}</title>

    <style>
      :root{
        --bg:#040409;
        --text:rgba(255,255,255,.92);
        --muted:rgba(255,255,255,.60);

        --glass: rgba(255,255,255,.06);
        --glass2: rgba(255,255,255,.10);
        --stroke: rgba(255,255,255,.14);
        --stroke2: rgba(160,160,255,.35);

        --shadow: 0 18px 55px rgba(0,0,0,.65);
        --radius: 22px;

        --max: 1120px;
        --navW: 240px;
      }

      html,body{height:100%;}
      body{
        margin:0;
        color:var(--text);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
        background:
          radial-gradient(1100px 750px at 70% 18%, rgba(120,120,255,.14), transparent 58%),
          radial-gradient(900px 650px at 18% 82%, rgba(0,255,200,.08), transparent 58%),
          var(--bg);
      }

      .wrap{ min-height:100%; display:flex; flex-direction:column; }

      header{
        padding:18px 18px 10px;
        display:flex;
        justify-content:center;
      }

      .brand{
        width:min(var(--max), 100%);
        display:flex;
        justify-content:space-between;
        align-items:flex-end;
        gap:14px;
      }

      .brand h1{ margin:0; font-size:18px; letter-spacing:.3px; }
      .brand p{ margin:6px 0 0; font-size:13px; color:var(--muted); }

      .pill{
        font-size:12px;
        color:var(--muted);
        border:1px solid var(--stroke);
        background:rgba(255,255,255,.04);
        padding:8px 10px;
        border-radius:999px;
        white-space:nowrap;
      }

      main{
        flex:1;
        display:flex;
        justify-content:center;
        padding:12px 18px 22px;
      }

      .shell{
        width:min(var(--max), 100%);
        display:grid;
        grid-template-columns: 1fr var(--navW);
        gap:18px;
        align-items:start;
      }

      /* CONTENIDO */
      .content{
        background:var(--glass);
        border:1px solid var(--stroke);
        border-radius:var(--radius);
        box-shadow:var(--shadow);
        padding:18px;
        backdrop-filter: blur(10px);
        min-height: 520px;
      }

      /* NAV “launcher” a la derecha */
      nav{
        position:sticky;
        top:14px;
        background:var(--glass);
        border:1px solid var(--stroke);
        border-radius:var(--radius);
        box-shadow:var(--shadow);
        padding:14px;
        backdrop-filter: blur(10px);
      }

      .navTitle{
        font-size:12px;
        color:var(--muted);
        text-transform:uppercase;
        letter-spacing:.14em;
        margin:2px 4px 12px;
      }

      .navGrid{
        display:grid;
        gap:14px;
      }

      .navCard{
        display:grid;
        grid-template-rows: 168px auto;
        border-radius:20px;
        border:1px solid rgba(255,255,255,.12);
        background: rgba(0,0,0,.22);
        overflow:hidden;
        text-decoration:none;
        color:var(--text);
        transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
      }

      .navCard:hover{
        transform: translateY(-1px);
        background: rgba(255,255,255,.06);
        border-color: rgba(255,255,255,.20);
      }

      .navCard.active{
        background: var(--glass2);
        border-color: var(--stroke2);
      }

      .thumb{
        display:grid;
        place-items:center;
        background: rgba(0,0,0,.28);
      }

      .thumb img{
        width: 108px;
        height: 108px;
        object-fit: contain;
      }

      .cap{
        padding:10px 12px 12px;
        display:flex;
        justify-content:space-between;
        align-items:center;
        gap:10px;
      }

      .cap strong{
        font-size:14px;
        text-transform:lowercase;
        letter-spacing:.2px;
      }

      .dot{
        width:8px;
        height:8px;
        border-radius:999px;
        background: rgba(255,255,255,.25);
      }
      .navCard.active .dot{
        background: rgba(140,200,255,.75);
      }

      footer{
        padding:14px 18px 18px;
        display:flex;
        justify-content:center;
        color:var(--muted);
        font-size:12px;
      }

      /* MOBILE */
      @media (max-width: 980px){
        .pill{ display:none; }
        .shell{ grid-template-columns: 1fr; }
        nav{ position:relative; top:0; order:-1; }
        .navGrid{
          grid-template-columns: repeat(3, minmax(0, 1fr));
          gap:10px;
        }
        .navCard{ grid-template-rows: 92px auto; }
        .thumb img{ width:54px; height:54px; }
        .cap{ padding:8px 10px; }
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <header>
        <div class="brand">
          <div>
            <h1>{title}</h1>
            <p>{description}</p>
          </div>
          <div class="pill">{BASE}</div>
        </div>
      </header>

      <main>
        <div class="shell">
          <section class="content">
            <slot />
          </section>

          <nav aria-label="Navegación">
            <div class="navTitle">Navegación</div>
            <div class="navGrid">
              {navItems.map((item) => (
                <a
                  class={"navCard" + (isActive(item.href) ? " active" : "")}
                  href={withBase(item.href)}
                >
                  <div class="thumb">
                    <img src={withBase(item.icon)} alt={item.label} loading="eager" />
                  </div>
                  <div class="cap">
                    <strong>{item.label}</strong>
                    <span class="dot"></span>
                  </div>
                </a>
              ))}
            </div>
          </nav>
        </div>
      </main>

      <footer>
        <div>Jaira Life RPG · GitHub Pages</div>
      </footer>
    </div>
  </body>
</html>
