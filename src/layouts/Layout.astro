---
type Props = {
  title?: string;
  description?: string;
};

const {
  title = "Jaira Life RPG",
  description = "Tu universo personal gamificado",
} = Astro.props as Props;

const currentPath = Astro.url.pathname;
const BASE = import.meta.env.BASE_URL;

const withBase = (path: string) => {
  const clean = path.replace(/^\//, "");
  return `${BASE}${clean}`;
};

const normalize = (p: string) => p.replace(/\/+$/, "") || "/";
const isActive = (href: string) => normalize(currentPath) === normalize(withBase(href));

const navItems = [
  { label: "home", href: "/", icon: "theme/icons/home.gif" },
  { label: "blog", href: "/blog/", icon: "theme/icons/blog.gif" },
  { label: "rpg", href: "/rpg/", icon: "theme/icons/rpg.gif" },
];

const BG = withBase("bg.jpg");
const HEADER = withBase("header.png");
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <title>{title}</title>

    <style>
      :root{
        --text: rgba(255,255,255,.92);
        --muted: rgba(255,255,255,.72);
        --stroke: rgba(255,255,255,.16);
        --stroke2: rgba(255,255,255,.10);
        --glass: rgba(0,0,0,.22);
        --glass2: rgba(255,255,255,.06);
        --shadow: 0 18px 60px rgba(0,0,0,.65);
        --radius: 26px;
      }

      html,body{height:100%;}
      body{
        margin:0;
        color:var(--text);
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
        background:#000;
        overflow-x:hidden;
      }

      /* Fondo */
      .bg{
        position:fixed;
        inset:0;
        background-image:url("{BG}");
        background-size:cover;
        background-position:center;
        transform:scale(1.03);
        z-index:-4;
      }

      /* oscurece + viñeta */
      .veil{
        position:fixed;
        inset:0;
        background:
          radial-gradient(1200px 700px at 50% 20%, rgba(255,255,255,.06), transparent 60%),
          radial-gradient(900px 650px at 80% 35%, rgba(140,120,255,.18), transparent 60%),
          radial-gradient(900px 650px at 20% 80%, rgba(0,255,200,.12), transparent 60%),
          linear-gradient(to bottom, rgba(0,0,0,.35), rgba(0,0,0,.68));
        z-index:-3;
      }

      /* blur real tipo “launcher” */
      .blur{
        position:fixed;
        inset:0;
        backdrop-filter: blur(14px);
        z-index:-2;
      }

      .wrap{
        min-height:100%;
        display:flex;
        flex-direction:column;
      }

      main{
        flex:1;
        display:flex;
        justify-content:center;
        padding: 28px 18px 34px;
      }

      .center{
        width:min(1100px, 100%);
        display:flex;
        flex-direction:column;
        align-items:center;
        gap: 18px;
      }

      /* Header grande centrado */
      .hero{
        display:flex;
        justify-content:center;
        width:100%;
        margin-top: 6px;
      }
      .hero img{
        width:min(560px, 92%);
        height:auto;
        filter: drop-shadow(0 24px 60px rgba(0,0,0,.75));
      }

      /* Launcher cards */
      .launcher{
        width:min(980px, 100%);
        background: var(--glass);
        border: 1px solid var(--stroke);
        border-radius: calc(var(--radius) + 8px);
        box-shadow: var(--shadow);
        padding: 22px;
        backdrop-filter: blur(12px);
      }

      .navGrid{
        display:grid;
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 22px;
      }

      .navCard{
        text-decoration:none;
        color:var(--text);
        background: rgba(0,0,0,.18);
        border: 1px solid var(--stroke2);
        border-radius: 28px;
        box-shadow: 0 18px 40px rgba(0,0,0,.32);
        padding: 18px;
        display:flex;
        flex-direction:column;
        align-items:center;
        gap: 14px;
        min-height: 240px;
        position:relative;
        overflow:hidden;
        transition: transform 140ms ease, background 140ms ease, border-color 140ms ease;
      }

      .navCard::before{
        content:"";
        position:absolute;
        inset:-2px;
        background: radial-gradient(700px 240px at 50% 0%, rgba(255,255,255,.10), transparent 55%);
        opacity:.75;
        pointer-events:none;
      }

      .navCard:hover{
        transform: translateY(-3px);
        background: rgba(255,255,255,.05);
        border-color: rgba(255,255,255,.22);
      }

      .navCard.active{
        background: rgba(140,160,255,.07);
        border-color: rgba(170,190,255,.55);
      }

      .iconBox{
        width: 100%;
        flex:1;
        display:grid;
        place-items:center;
        border-radius: 22px;
        background: rgba(255,255,255,.04);
        border: 1px solid rgba(255,255,255,.12);
      }

      .iconBox img{
        width: 150px;
        height: 150px;
        object-fit: contain;
      }

      .labelRow{
        width:100%;
        display:flex;
        align-items:center;
        justify-content:center;
        gap:10px;
        padding-top: 2px;
      }

      .labelRow span{
        font-size: 18px;
        text-transform: lowercase;
        opacity:.90;
        letter-spacing:.2px;
      }

      .dot{
        width:10px;
        height:10px;
        border-radius:999px;
        background: rgba(255,255,255,.22);
      }

      .navCard.active .dot{
        background: rgba(140,190,255,.85);
        box-shadow: 0 0 0 7px rgba(140,190,255,.12);
      }

      /* Texto abajo como antes */
      .content{
        width:min(980px, 100%);
        margin-top: 10px;
        padding: 10px 6px 0;
        align-self: center;
      }

      .content :global(h1){
        margin:0;
        font-size: 44px;
        font-weight: 800;
        letter-spacing: .2px;
        text-shadow: 0 18px 55px rgba(0,0,0,.65);
      }

      .content :global(p){
        margin: 10px 0 0;
        font-size: 16px;
        color: var(--muted);
        line-height: 1.6;
        max-width: 80ch;
        text-shadow: 0 18px 55px rgba(0,0,0,.65);
      }

      footer{
        padding: 12px 18px 22px;
        display:flex;
        justify-content:center;
        color: rgba(255,255,255,.55);
        font-size: 12px;
      }

      @media (max-width: 900px){
        .navGrid{ grid-template-columns: 1fr; }
        .navCard{ min-height: 210px; }
        .iconBox img{ width: 135px; height: 135px; }
        .content :global(h1){ font-size: 34px; }
      }
    </style>
  </head>

  <body>
    <div class="bg"></div>
    <div class="veil"></div>
    <div class="blur"></div>

    <div class="wrap">
      <main>
        <div class="center">
          <div class="hero">
            <img src={HEADER} alt="Jai RPG" loading="eager" />
          </div>

          <section class="launcher" aria-label="launcher">
            <div class="navGrid">
              {navItems.map((item) => (
                <a
                  class={"navCard" + (isActive(item.href) ? " active" : "")}
                  href={withBase(item.href)}
                >
                  <div class="iconBox">
                    <img src={withBase(item.icon)} alt={item.label} loading="eager" />
                  </div>
                  <div class="labelRow">
                    <span>{item.label}</span>
                    <i class="dot"></i>
                  </div>
                </a>
              ))}
            </div>
          </section>

          <section class="content">
            <slot />
          </section>
        </div>
      </main>

      <footer>Jaira Life RPG · GitHub Pages</footer>
    </div>
  </body>
</html>
